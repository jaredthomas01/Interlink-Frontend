<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Applications</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6 font-sans">
  <h2 class="text-2xl font-bold mb-6 text-center">Applications Dashboard</h2>

  <!-- applications section starts -->
<section class="featured" id="applications">
  <h1 class="heading"><span>Latest Applications</span></h1>

  <div class="swiper featured-slider">
    <div class="swiper-wrapper" id="featured-container">
      <!-- Applications will be inserted here dynamically -->
    </div>

    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
  </div>
</section>
<!-- applications section ends -->


  <script>
    // Applications section

function fetchApplications() {
  fetch('http://localhost:8080/applications')
    .then(response => {
      if (!response.ok) throw new Error("Failed to fetch applications");
      return response.json();
    })
    .then(data => {
      const apps = getLatestApplicationsById(data);
      displayApplications(apps);
    })
    .catch(error => console.error('Error fetching applications:', error));
}

function getLatestApplicationsById(applications) {
  return applications
    .sort((a, b) => b.id - a.id)
    .slice(0, 10);
}

function displayApplications(applications) {
  const container = document.getElementById('featured-container'); // reused featured-container ID
  container.innerHTML = '';

  applications.forEach(app => {
    const element = document.createElement('a');
    element.href = "#";
    element.classList.add('swiper-slide', 'box');

    element.innerHTML = `
      <div class="icons">
        <a href="#" class="fas fa-search"></a>
        <a href="#" class="fas fa-heart"></a>
        <a href="#" class="fas fa-eye"></a>
      </div>
      <div class="content">
        <h3>${app.placement?.title || "Untitled Position"}</h3>
        <p><strong>Student:</strong> ${app.student?.name || "N/A"}</p>
        <p><strong>Company:</strong> ${app.placement?.company?.name || "Unknown"}</p>
        <div class="price">Status: ${app.status}</div>
        <div class="stars">
          ${getStars(app.status === "APPROVED" ? 5 : app.status === "REJECTED" ? 2 : 3)}
        </div>
        <a href="#" class="btn">View Application</a>
      </div>
    `;

    container.appendChild(element);
  });

  new Swiper(".featured-slider", {
    spaceBetween: 10,
    loop: true,
    centeredSlides: true,
    autoplay: {
      delay: 9500,
      disableOnInteraction: false,
    },
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    breakpoints: {
      0: { slidesPerView: 1 },
      768: { slidesPerView: 2 },
      1024: { slidesPerView: 3 },
    },
  });
}

function getStars(rating) {
  let stars = '';
  for (let i = 0; i < 5; i++) {
    if (i < rating) {
      stars += '<i class="fas fa-star"></i>';
    } else {
      stars += '<i class="far fa-star"></i>';
    }
  }
  return stars;
}

document.addEventListener('DOMContentLoaded', fetchApplications);

// Generic UI interactions
var searchForm = document.querySelector('.search-form');

document.querySelector('#search-btn').onclick = () => {
  searchForm.classList.toggle('active');
}

function loader() {
  document.querySelector('.loader-container').classList.add('active');
}

function fadeOut() {
  setTimeout(loader, 4000);
}

var swiper = new Swiper(".books-slider", {
  loop: true,
  centeredSlides: true,
  autoplay: {
    delay: 9500,
    disableOnInteraction: false,
  },
  breakpoints: {
    0: { slidesPerView: 1 },
    768: { slidesPerView: 2 },
    1024: { slidesPerView: 3 },
  },
});

var swiper = new Swiper(".reviews-slider", {
  spaceBetween: 10,
  grabCursor: true,
  loop: true,
  centeredSlides: true,
  autoplay: {
    delay: 9500,
    disableOnInteraction: false,
  },
  breakpoints: {
    0: { slidesPerView: 1 },
    768: { slidesPerView: 2 },
    1024: { slidesPerView: 3 },
  },
});

var swiper = new Swiper(".blogs-slider", {
  spaceBetween: 10,
  grabCursor: true,
  loop: true,
  centeredSlides: true,
  autoplay: {
    delay: 9500,
    disableOnInteraction: false,
  },
  breakpoints: {
    0: { slidesPerView: 1 },
    768: { slidesPerView: 2 },
    1024: { slidesPerView: 3 },
  },
});

  </script>
  
  
</body>
</html>